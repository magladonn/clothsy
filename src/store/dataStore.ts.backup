import type { Product, Order, Subscriber, SiteStats, AdminUser } from '@/types';

// Admin credentials
export const ADMIN_USERS: AdminUser[] = [
  { username: 'admin1', password: 'clothsy2025' },
  { username: 'admin2', password: 'clothsy2025' },
  { username: 'admin3', password: 'clothsy2025' }
];

// ALL Moroccan cities (complete list from all 12 regions)
export const MOROCCAN_CITIES = [
  // Casablanca-Settat Region
  'Casablanca', 'Mohammedia', 'Settat', 'El Jadida', 'Benslimane', 'Berrechid', 'Mediouna', 'Nouaceur',
  'Tit Mellil', 'Ain Harrouda', 'Sidi Rahal', 'Bouznika', 'Skhirat', 'Ben Ahmed', 'Oulad Frej',
  'Sidi Bennour', 'Sidi Smail', 'Azemmour', 'Oualidia', 'Zemamra', 'Bir Jdid', 'Lahraouyine',
  'Ain Sebaa', 'Hay Hassani', 'Sidi Bernoussi', 'Sidi Moumen', 'Ben Msik', 'Sidi Othmane',
  'Al Fida', 'Mers Sultan', 'Anfa', 'Maarif', 'Gauthier', 'Racine', 'Bourgogne',
  'Les Hopitaux', 'Sidi Maarouf', 'Californie', 'Oasis', 'Ain Chock', 'Hay Mohammadi',
  // Rabat-Sale-Kenitra Region
  'Rabat', 'Sale', 'Kenitra', 'Temara', 'Skhirat', 'Khemisset', 'Sidi Slimane', 'Sidi Yahya',
  'Sidi Kacem', 'Mehdia', 'Salé El Jadida', 'Tabriquet', 'Bettana', 'Hssain', 'Bab Lamrissa',
  'Hay Karima', 'Hay Rahma', 'El Menzeh', 'Souissi', 'Agdal', 'Hassan', 'Les Orangers',
  // Marrakech-Safi Region
  'Marrakech', 'Safi', 'El Kelaa des Sraghna', 'Essaouira', 'Youssoufia', 'Chichaoua',
  'Ben Guerir', 'Tameslouht', 'Ait Ourir', 'Amizmiz', 'Asni', 'Tahannaout', 'Tamansourt',
  'Sidi Rahhal', 'Smimou', 'Tafetachte', 'Talmest', 'Tamanar', 'Ida Ougourd', 'Imintanoute',
  // Fes-Meknes Region
  'Fes', 'Meknes', 'Taza', 'Sefrou', 'Boulemane', 'Moulay Yacoub', 'El Hajeb', 'Ifrane',
  'Azrou', 'Bhalil', 'Imouzzer Kandar', 'Ain Taoujdate', 'My Ali Cherif', 'Missour',
  'Outat El Haj', 'Rissani', 'Arfoud', 'Ahermoumou', 'Boufakrane', 'Mrirt', 'Khenifra',
  // Tangier-Tetouan-Al Hoceima Region
  'Tangier', 'Tetouan', 'Al Hoceima', 'Larache', 'Asilah', 'Fnideq', 'Martil', 'Mdiq',
  'Chefchaouen', 'Oued Laou', 'Bab Berred', 'Bab Taza', 'Bni Bouayach', 'Bni Hadifa',
  'Imzouren', 'Issaguen', 'Ketama', 'Ouezzane', 'Targuist', 'Taza El Jadida', 'Zoumi',
  // Oriental Region
  'Oujda', 'Nador', 'Berkane', 'Jerada', 'Taourirt', 'Figuig', 'Ain Beni Mathar',
  'Ahfir', 'Ain El Aouda', 'Ain Erreggada', 'Beni Ansar', 'Beni Drar', 'Bouanane',
  'Bouarfa', 'Bouhdila', 'Bni Tadjite', 'Debdou', 'Driouch', 'El Aioun', 'Guercif',
  'Hassi Berkane', 'Jaadar', 'Laatamna', 'Madagh', 'Ras El Ma', 'Saidia', 'Selouane',
  'Sidi Bouhria', 'Sidi Slimane Echcharaa', 'Tafoughalt', 'Tendrara', 'Touissit', 'Zaio',
  // Souss-Massa Region
  'Agadir', 'Inezgane', 'Ait Melloul', 'Tiznit', 'Taroudant', 'Oulad Teima', 'Tata',
  'Biougra', 'Drargua', 'Dcheira El Jihadia', 'Aourir', 'Dcheira', 'Irherm', 'Lqliaa',
  'Massa', 'Sidi Bibi', 'Sidi Ifni', 'Tafraout', 'Tamraght', 'Temsia', 'Ait Baha',
  'Ait Iaaza', 'Aoulouz', 'El Guerdane', 'Imsouane', 'Sidi Moussa Lhamri', 'Taliouine',
  // Guelmim-Oued Noun Region
  'Guelmim', 'Tan-Tan', 'Sidi Ifni', 'Assa', 'Zag', 'Bouizakarne', 'Foum Zguid',
  'Lakhsas', 'Plage Blanche', 'Taghjijt', 'Tiglit', 'Tighmert', 'Ait Boufoulen',
  'Aouinet', 'Bouanane', 'Ibn Chambred', 'Lemsid', 'Tarsouat', 'Tigmmi',
  // Laayoune-Sakia El Hamra Region
  'Laayoune', 'Boujdour', 'Tarfaya', 'Es-Semara', 'Dakhla', 'Haouza', 'Jdiriya',
  'El Marsa', 'Foum El Oued', 'Aousserd', 'Amgala', 'Bir Anzarane', 'Chlaghmim',
  'Chtouka', 'Dougoum', 'Guelta Zemmur', 'Imlili', 'Jraifia', 'Lamsid', 'Mijik',
  'Oum Dreyga', 'Tichla', 'Zoug', 'Chirfa', 'El Argoub', 'Guerguerat', 'Imlili',
  // Dakhla-Oued Ed-Dahab Region
  'Dakhla', 'Aousserd', 'Bir Gandouz', 'Gleibat El Foula', 'Imlili', 'Mijik',
  'Oum Dreyga', 'Tichla', 'Zoug', 'Chirfa', 'El Argoub', 'Guerguerat', 'Aouinet',
  'Bouanane', 'Ibn Chambred', 'Lemsid', 'Tarsouat', 'Tigmmi', 'Aglou', 'Aridal',
  'Bouizakarne', 'Foum Zguid', 'Lakhsas', 'Plage Blanche', 'Taghjijt', 'Tiglit',
  // Beni Mellal-Khenifra Region
  'Beni Mellal', 'Khouribga', 'Khenifra', 'Azilal', 'Fquih Ben Salah', 'Ouaouizeght',
  'Demnate', 'Kasba Tadla', 'Oulad Ayad', 'Souk Sebt Oulad Nemma', 'Zaouiat Cheikh',
  'Afourar', 'Ait Ishaq', 'Ait Oum El Bekht', 'Boujniba', 'Boulanouare', 'Bradia',
  'Dar Ould Zidouh', 'El Ksiba', 'Fetouaka', 'Had Bouhssoussen', 'Kasbat Troch',
  'Kerrouchen', 'Mrirt', 'Naour', 'Oulad Mbarek', 'Oulad Yaich', 'Sidi Jaber',
  'Sidi Lamine', 'Tafraout', 'Taghzirt', 'Tighassaline', 'Tizi Nisly', 'Zawyat',
  // Draa-Tafilalet Region
  'Errachidia', 'Ouarzazate', 'Midelt', 'Tinghir', 'Zagora', 'Rissani', 'Erfoud',
  'Goulmima', 'Taznakht', 'Agdz', 'Alnif', 'Boumalne Dades', 'Imilchil', 'Mhamid',
  'Nkob', 'Skoura', 'Tamegroute', 'Tazenakht', 'Tinejdad', 'Ait Hani', 'Amellagou',
  'Amersid', 'Aoufous', 'Arfoud', 'Assoul', 'Boudnib', 'El Hart', 'Enjil', 'Errouha',
  'Fezna', 'Ferkla', 'Gheris', 'Goulmima', 'Hassi Berdad', 'Hassi Mbarek', 'Hassi',
  'Ighil N Oumgoun', 'Ighrem N Ougdal', 'Imider', 'Imilchil', 'Jorf', 'Ksar Tazougart',
  'M Ssici', 'Melaab', 'Mibladen', 'Moulay Ali Cherif', 'My Brahim Salah', 'N Oual',
  'Ouaouizeght', 'Ouarzazate', 'Rich', 'Sidi Ayad', 'Tabant', 'Taghzirt N Imilchil',
  'Tamellalt', 'Tamedakhte', 'Tameslohte', 'Taznakht', 'Telouet', 'Tiddas', 'Tifernine',
  'Tighdouine', 'Tighza', 'Tinejdad', 'Tisrasse', 'Tizi N Ougoug', 'Toundoute', 'Tounfite',
  'Zagora', 'Zaouiat Sidi Hamza', 'Zaouiat Sidi Salah',
  // Other
  'Other'
];

// EmailJS configuration - ✅ CONFIGURED
export const EMAILJS_CONFIG = {
  serviceId: 'service_gn8ecp6',
  templateId: 'template_ft3yuor',
  publicKey: 'HyBzOZ_aiLwpVDlq0',
  email: 'clothsy.business.ma@gmail.com',
  phone: '+212786193181'
};

// Supabase configuration - ✅ CONFIGURED
export const SUPABASE_CONFIG = {
  url: 'https://fdgvhmgxyxdnxwhvmrhk.supabase.co',
  apiKey: 'sb_publishable_StTNEygqktlS_s0p26-3yA_ioUXh10q'
};

// Sample products using the uploaded images
const sampleProducts: Product[] = [
  {
    id: '1',
    code: 'PK-01',
    name: 'Hello Kitty Pink Pajama Pants',
    description: 'Ultra-soft fleece pajama pants featuring the iconic Hello Kitty pattern. Perfect for lounging in style and comfort. Elastic waistband with drawstring for adjustable fit.',
    price: 149,
    sizes: ['S', 'M', 'L', 'XL'],
    colors: ['Pink'],
    images: ['/images/a6d77f0d-84ac-4b80-9f86-4c1914f66d41.jpeg'],
    category: 'womens',
    inStock: true,
    visible: true,
    createdAt: '2024-01-15T10:00:00Z'
  },
  {
    id: '2',
    code: 'JC-10',
    name: 'Hello Kitty Lounge Pants',
    description: 'Cozy lounge pants with all-over Hello Kitty print. Made from premium cotton blend for everyday comfort. Features elastic waist and relaxed fit.',
    price: 129,
    sizes: ['XS', 'S', 'M', 'L', 'XL'],
    colors: ['Pink', 'White'],
    images: ['/images/49f9b145-80e0-4a53-b888-c4e5c225091c.jpeg'],
    category: 'womens',
    inStock: true,
    visible: true,
    createdAt: '2024-01-14T14:30:00Z'
  },
  {
    id: '3',
    code: 'BL-01',
    name: 'Essential Black Sweatpants',
    description: 'Classic black sweatpants crafted from heavyweight cotton fleece. Features white drawstring, ribbed cuffs, and side pockets. The ultimate streetwear essential.',
    price: 199,
    sizes: ['S', 'M', 'L', 'XL', 'XXL'],
    colors: ['Black', 'Gray', 'Navy'],
    images: ['/images/fd23f38b-8591-46c9-97d1-c0df9da76fff.jpeg'],
    category: 'mens',
    inStock: true,
    visible: true,
    createdAt: '2024-01-13T09:15:00Z'
  },
  {
    id: '4',
    code: 'SL-03',
    name: 'Minimal Cotton Tee',
    description: 'Clean, minimal cotton t-shirt with perfect drape. Premium heavyweight fabric that holds its shape. Essential wardrobe staple.',
    price: 99,
    sizes: ['S', 'M', 'L', 'XL'],
    colors: ['White', 'Black', 'Gray'],
    images: ['/images/a6d77f0d-84ac-4b80-9f86-4c1914f66d41.jpeg'],
    category: 'mens',
    inStock: true,
    visible: true,
    createdAt: '2024-01-12T16:45:00Z'
  },
  {
    id: '5',
    code: 'SG-03',
    name: 'Oversized Hoodie',
    description: 'Ultra-comfortable oversized hoodie with dropped shoulders. Heavyweight fleece interior for maximum warmth. Perfect layering piece.',
    price: 249,
    sizes: ['S', 'M', 'L', 'XL'],
    colors: ['Black', 'Gray', 'Beige'],
    images: ['/images/fd23f38b-8591-46c9-97d1-c0df9da76fff.jpeg'],
    category: 'womens',
    inStock: true,
    visible: true,
    createdAt: '2024-01-11T11:20:00Z'
  },
  {
    id: '6',
    code: 'BP-02',
    name: 'Canvas Tote Bag',
    description: 'Durable canvas tote bag with minimalist design. Perfect for everyday carry. Reinforced handles and interior pocket.',
    price: 79,
    sizes: ['One Size'],
    colors: ['Natural', 'Black'],
    images: ['/images/49f9b145-80e0-4a53-b888-c4e5c225091c.jpeg'],
    category: 'accessories',
    inStock: true,
    visible: true,
    createdAt: '2024-01-10T13:00:00Z'
  }
];

// Initialize store
class DataStore {
  private products: Product[] = [...sampleProducts];
  private orders: Order[] = [];
  private subscribers: Subscriber[] = [];
  private stats: SiteStats = {
    totalVisits: 1247,
    totalOrders: 89,
    totalProducts: 6,
    totalSubscribers: 234,
    ordersByStatus: {
      pending: 12,
      confirmed: 25,
      shipped: 35,
      delivered: 15,
      cancelled: 2
    },
    visitsByDate: [
      { date: '2024-01-25', visits: 145 },
      { date: '2024-01-26', visits: 189 },
      { date: '2024-01-27', visits: 167 },
      { date: '2024-01-28', visits: 203 },
      { date: '2024-01-29', visits: 178 },
      { date: '2024-01-30', visits: 198 },
      { date: '2024-01-31', visits: 167 }
    ],
    ordersByDate: [
      { date: '2024-01-25', orders: 10 },
      { date: '2024-01-26', orders: 15 },
      { date: '2024-01-27', orders: 12 },
      { date: '2024-01-28', orders: 18 },
      { date: '2024-01-29', orders: 14 },
      { date: '2024-01-30', orders: 16 },
      { date: '2024-01-31', orders: 4 }
    ]
  };

  // Admin Authentication
  authenticateAdmin(username: string, password: string): boolean {
    return ADMIN_USERS.some(admin => admin.username === username && admin.password === password);
  }

  // Products
  getProducts(): Product[] {
    return [...this.products].sort((a, b) => new Date(b.createdAt).getTime() - new Date(a.createdAt).getTime());
  }

  getVisibleProducts(): Product[] {
    return this.getProducts().filter(p => p.visible);
  }

  getProductById(id: string): Product | undefined {
    return this.products.find(p => p.id === id);
  }

  getProductsByCategory(category: string): Product[] {
    if (category === 'all') return this.getVisibleProducts();
    return this.products.filter(p => p.category === category && p.visible);
  }

  addProduct(product: Omit<Product, 'id' | 'createdAt'>): Product {
    const newProduct: Product = {
      ...product,
      id: Date.now().toString(),
      createdAt: new Date().toISOString()
    };
    this.products.push(newProduct);
    this.stats.totalProducts = this.products.length;
    return newProduct;
  }

  updateProduct(id: string, updates: Partial<Product>): boolean {
    const index = this.products.findIndex(p => p.id === id);
    if (index > -1) {
      this.products[index] = { ...this.products[index], ...updates };
      return true;
    }
    return false;
  }

  deleteProduct(id: string): boolean {
    const index = this.products.findIndex(p => p.id === id);
    if (index > -1) {
      this.products.splice(index, 1);
      this.stats.totalProducts = this.products.length;
      return true;
    }
    return false;
  }

  toggleProductVisibility(id: string): boolean {
    const product = this.products.find(p => p.id === id);
    if (product) {
      product.visible = !product.visible;
      return true;
    }
    return false;
  }

  // Orders
  getOrders(): Order[] {
    return [...this.orders].sort((a, b) => new Date(b.createdAt).getTime() - new Date(a.createdAt).getTime());
  }

  addOrder(order: Omit<Order, 'id' | 'createdAt' | 'status'>): Order {
    const newOrder: Order = {
      ...order,
      id: 'CLTH-' + Date.now().toString().slice(-6),
      status: 'pending',
      createdAt: new Date().toISOString()
    };
    this.orders.push(newOrder);
    this.stats.totalOrders++;
    this.stats.ordersByStatus.pending++;
    return newOrder;
  }

  updateOrderStatus(orderId: string, status: Order['status']): boolean {
    const order = this.orders.find(o => o.id === orderId);
    if (order) {
      this.stats.ordersByStatus[order.status]--;
      order.status = status;
      this.stats.ordersByStatus[status]++;
      return true;
    }
    return false;
  }

  deleteOrder(orderId: string): boolean {
    const index = this.orders.findIndex(o => o.id === orderId);
    if (index > -1) {
      const order = this.orders[index];
      this.stats.ordersByStatus[order.status]--;
      this.orders.splice(index, 1);
      this.stats.totalOrders--;
      return true;
    }
    return false;
  }

  // Subscribers
  getSubscribers(): Subscriber[] {
    return [...this.subscribers];
  }

  addSubscriber(email: string): Subscriber | null {
    if (this.subscribers.find(s => s.email === email)) {
      return null;
    }
    const newSubscriber: Subscriber = {
      id: Date.now().toString(),
      email,
      subscribedAt: new Date().toISOString()
    };
    this.subscribers.push(newSubscriber);
    this.stats.totalSubscribers++;
    return newSubscriber;
  }

  // Stats
  getStats(): SiteStats {
    return { ...this.stats };
  }

  recordVisit(): void {
    this.stats.totalVisits++;
    const today = new Date().toISOString().split('T')[0];
    const todayEntry = this.stats.visitsByDate.find(v => v.date === today);
    if (todayEntry) {
      todayEntry.visits++;
    } else {
      this.stats.visitsByDate.push({ date: today, visits: 1 });
    }
    if (this.stats.visitsByDate.length > 7) {
      this.stats.visitsByDate.shift();
    }
  }

  // Export orders to CSV
  exportOrdersToCSV(): string {
    const orders = this.getOrders();
    const headers = ['Order ID,Date,Customer,Phone,City,Items,Total,Status,Notes'];
    const rows = orders.map(order => {
      const total = order.productPrice * order.quantity;
      return `${order.id},${new Date(order.createdAt).toLocaleDateString()},${order.customerName},${order.customerPhone},${order.customerCity},${order.quantity},${total},${order.status},"${order.notes || ''}"`;
    });
    return [...headers, ...rows].join('\n');
  }
}

export const dataStore = new DataStore();

// Format price in MAD
export function formatPrice(price: number): string {
  return `${price} MAD`;
}
